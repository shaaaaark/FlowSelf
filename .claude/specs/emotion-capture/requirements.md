# 情绪记录模块 - 需求规格

**Version**: 1.0
**Date**: 2025-12-30
**Status**: Confirmed

---

## 1. 项目背景

- **项目名称**: FlowSelf
- **项目定位**: 禅意数字花园风格的个人成长应用
- **技术栈**: Expo 52 + React Native 0.76 + TypeScript + Zustand + expo-sqlite/Drizzle + Reanimated 3

## 2. 本次开发范围

### 2.1 开发模式
- **交付方式**: 分模块递增开发
- **当前阶段**: 情绪记录模块（Phase 1）
- **测试要求**: 单元测试覆盖率 ≥90%

### 2.2 允许的 AI 后端
- `codex` - 默认任务
- `claude` - 快速修复
- `gemini` - UI/UX 任务

## 3. 功能需求

### 3.1 情绪记录（核心功能）

**设计原则**: 3秒原则 - 极低输入摩擦

**交互流程**:
```
[进入] → [选择emoji] → [可选标签] → [自动保存退出]
         ↓
    单次点击完成
```

**功能要求**:
- 首屏直接展示 7 个核心情绪 emoji，无需额外导航
- 标签为可选，不阻断主流程
- 自动保存，无确认按钮
- 支持触觉反馈 (expo-haptics)

### 3.2 动态主题系统

**6种情绪主题色**:

| 情绪 | 英文 | 主色 | 辅色 | 背景渐变 |
|------|------|------|------|----------|
| 平静 | Calm | `#2D5A5A` | `#4A7C7C` | 深青→浅青 |
| 愉悦 | Joy | `#E8A87C` | `#F5C9A8` | 暖杏→奶油 |
| 专注 | Focus | `#4A5568` | `#718096` | 靛蓝→灰蓝 |
| 活力 | Energy | `#FF6B6B` | `#FFA8A8` | 珊瑚→粉橙 |
| 沉思 | Reflect | `#9F7AEA` | `#C4A8FF` | 薰衣草→淡紫 |
| 疲惫 | Tired | `#718096` | `#A0AEC0` | 烟灰→浅灰 |

**要求**:
- 主题切换时平滑过渡动画
- 基于 React Context 实现
- 持久化用户偏好

### 3.3 数据持久化

**存储方案**: expo-sqlite + Drizzle ORM

**数据模型**:
- 情绪记录 (emotion_logs): id, emoji, mood_type, tags[], note?, timestamp
- 用户设置 (settings): theme_preference, last_mood

## 4. 非功能需求

- **性能**: 首屏渲染 < 500ms
- **动画**: 使用 Reanimated 3，60fps 流畅
- **可访问性**: 语义化组件，支持屏幕阅读器

## 5. 验收标准

- [ ] 情绪选择器支持 7 种情绪
- [ ] 点击情绪后自动保存并触发触觉反馈
- [ ] 主题根据选择的情绪自动切换
- [ ] 数据持久化到本地 SQLite
- [ ] 单元测试覆盖率 ≥90%

---

## 变更记录

| 日期 | 版本 | 变更内容 |
|------|------|----------|
| 2025-12-30 | 1.0 | 初始需求规格 |
